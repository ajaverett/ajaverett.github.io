---
title: "Barplot Cheatsheet in R"
subtitle: "Fun with barplots"
title-block-banner: ../../images/banner.png
title-block-banner-color: 'white'
image: "qreg.webp"
categories: ["Visualization"]
format:
  html:
    code-fold: true
    code-summary: "Show the code"
---
  

# Barplots in R


## Counts in Barplots

```{r}
#| warning: false

library(tidyverse)

mpg %>% 
  mutate(manufacturer=str_to_title(manufacturer)) %>% 
  ggplot(aes(y=fct_rev(fct_infreq(manufacturer)))) +
  geom_bar(fill="darkblue") +
  labs(y="Manufacturer") +
  theme_classic() 
```

or

```{r}
mpg %>% 
  mutate(manufacturer=str_to_title(manufacturer)) %>% 
  group_by(manufacturer) %>% 
  count() %>% 
  ggplot(aes(y=fct_reorder(manufacturer,n), x=n)) +
  geom_col(fill="darkblue") +
  labs(y="Manufacturer") +
  theme_classic() +
  geom_text(aes(label=n), hjust=-0.3)

```



```{r}
mtcars %>% 
  group_by(am,cyl) %>% 
  count() %>% 
  ggplot(aes(x=as.factor(cyl), y=n, fill = as.factor(am))) +
  geom_bar(stat = "identity", position = "stack") +
  theme_classic() 
```



```{r}
mtcars %>% 
  group_by(am,cyl) %>% 
  count() %>% 
  ggplot(aes(x=as.factor(cyl), y=n, fill = as.factor(am))) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_classic() +
  geom_text(aes(label = n), 
            position = position_dodge(width = 0.9), # Adjust the dodge width if necessary
            vjust = -0.25, # Adjust vertical position to be slightly above the bars
            hjust = 0.5)
```


```{r}
mtcars %>% 
  group_by(am,cyl) %>% 
  count() %>% 
  ggplot(aes(x=as.factor(cyl), y=n, fill = as.factor(am))) +
  geom_bar(stat = "identity", position = "fill")+
  theme_classic() +
  scale_y_continuous(labels = scales::percent) +
  geom_text(aes(label = scales::percent(n/sum(n), accuracy = 1), 
                y = n/sum(n)/2), 
            position = position_fill(), vjust = 2)

```

```{r}
library(sjPlot)
library(likert)  

data(pisaitems) 

pisaitems %>% 
  select(starts_with("ST25Q")) %>% 
  plot_likert()

```






